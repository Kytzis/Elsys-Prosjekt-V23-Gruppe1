<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>EyeText</title>

	<style>
		body {
			margin: 0;
			padding: 0;
		}
		
		video {
			position: absolute;
			top: 0;
			left: 0;
			width: 50vw;
			height: 50vh;
		}
		
		video:nth-child(1) {
			top: 0;
			left: 0;
		}
		
		video:nth-child(2) {
			top: 0;
			left: 50vw;
		}
		
		video:nth-child(3) {
			top: 50vh;
			left: 0;
		}
		
		video:nth-child(4) {
			top: 50vh;
			left: 50vw;
		}
	</style>
</head>
<body>
	<video src="video/1.mp4" loop></video>
	<video src="video/2.mp4"  loop></video>
	<video src="video/3.mp4"  loop></video>
	<video src="video/4.mp4" loop></video>

    <script>
		const videos = document.querySelectorAll('video');
		let videoNr = null;
		const videoTime = [0,0,0,0]
		
		videos.forEach( async function (video, index) {
			video.addEventListener('click', () => {
				videos.forEach((otherVideo, otherIndex) => {
					if (otherVideo !== video) {
						otherVideo.pause();
					}
					videoTime[otherIndex] = otherVideo.currentTime*1000;
				});
				video.play();
				videoNr = index + 1;
				console.log('Video nr. ' + videoNr + ' spilles nå.');
				console.log("Current Video time: " + videoTime[index])

				const data = {
					id: videoNr,
					time: videoTime[videoNr],
				}
                console.log(JSON.stringify(data))
				// a POST request
				const response = fetch('http://192.168.116.202:8001/setvideo', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json; charset=utf-8'
					},
					body: JSON.stringify(data),
					})
				});	
		});

		//id: "id", type: "string", data: "navn på video"
		//id: "time", type: "int", data: "Tidsstempel i video i ms"

		//Sender over videoNr og videoTime[videoNr] som JSON
		// {videoNr, videoTime[videoNr]}
	</script>

</body>
</html>
